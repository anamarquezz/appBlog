{"ast":null,"code":"const LRUCache = require('lru-cache');\n\nconst dns = require('dns');\n\nconst defaultOptions = exports.defaultOptions = {\n  family: undefined,\n  hints: dns.ADDRCONFIG,\n  all: false,\n  verbatim: undefined\n};\nconst lookupCache = exports.lookupCache = new LRUCache({\n  max: 50\n}); // this is a factory so that each request can have its own opts (i.e. ttl)\n// while still sharing the cache across all requests\n\nexports.getLookup = dnsOptions => {\n  return (hostname, options, callback) => {\n    if (typeof options === 'function') {\n      callback = options;\n      options = null;\n    } else if (typeof options === 'number') {\n      options = {\n        family: options\n      };\n    }\n\n    options = { ...defaultOptions,\n      ...options\n    };\n    const key = JSON.stringify({\n      hostname,\n      family: options.family,\n      hints: options.hints,\n      all: options.all,\n      verbatim: options.verbatim\n    });\n\n    if (lookupCache.has(key)) {\n      const [address, family] = lookupCache.get(key);\n      process.nextTick(callback, null, address, family);\n      return;\n    }\n\n    dnsOptions.lookup(hostname, options, (err, address, family) => {\n      if (err) {\n        return callback(err);\n      }\n\n      lookupCache.set(key, [address, family], {\n        ttl: dnsOptions.ttl\n      });\n      return callback(null, address, family);\n    });\n  };\n};","map":{"version":3,"names":["LRUCache","require","dns","defaultOptions","exports","family","undefined","hints","ADDRCONFIG","all","verbatim","lookupCache","max","getLookup","dnsOptions","hostname","options","callback","key","JSON","stringify","has","address","get","process","nextTick","lookup","err","set","ttl"],"sources":["C:/sources/GitHub/appBlog/BlogLab/BlogLab-UI/node_modules/make-fetch-happen/lib/dns.js"],"sourcesContent":["const LRUCache = require('lru-cache')\nconst dns = require('dns')\n\nconst defaultOptions = exports.defaultOptions = {\n  family: undefined,\n  hints: dns.ADDRCONFIG,\n  all: false,\n  verbatim: undefined,\n}\n\nconst lookupCache = exports.lookupCache = new LRUCache({ max: 50 })\n\n// this is a factory so that each request can have its own opts (i.e. ttl)\n// while still sharing the cache across all requests\nexports.getLookup = (dnsOptions) => {\n  return (hostname, options, callback) => {\n    if (typeof options === 'function') {\n      callback = options\n      options = null\n    } else if (typeof options === 'number') {\n      options = { family: options }\n    }\n\n    options = { ...defaultOptions, ...options }\n\n    const key = JSON.stringify({\n      hostname,\n      family: options.family,\n      hints: options.hints,\n      all: options.all,\n      verbatim: options.verbatim,\n    })\n\n    if (lookupCache.has(key)) {\n      const [address, family] = lookupCache.get(key)\n      process.nextTick(callback, null, address, family)\n      return\n    }\n\n    dnsOptions.lookup(hostname, options, (err, address, family) => {\n      if (err) {\n        return callback(err)\n      }\n\n      lookupCache.set(key, [address, family], { ttl: dnsOptions.ttl })\n      return callback(null, address, family)\n    })\n  }\n}\n"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,WAAD,CAAxB;;AACA,MAAMC,GAAG,GAAGD,OAAO,CAAC,KAAD,CAAnB;;AAEA,MAAME,cAAc,GAAGC,OAAO,CAACD,cAAR,GAAyB;EAC9CE,MAAM,EAAEC,SADsC;EAE9CC,KAAK,EAAEL,GAAG,CAACM,UAFmC;EAG9CC,GAAG,EAAE,KAHyC;EAI9CC,QAAQ,EAAEJ;AAJoC,CAAhD;AAOA,MAAMK,WAAW,GAAGP,OAAO,CAACO,WAAR,GAAsB,IAAIX,QAAJ,CAAa;EAAEY,GAAG,EAAE;AAAP,CAAb,CAA1C,C,CAEA;AACA;;AACAR,OAAO,CAACS,SAAR,GAAqBC,UAAD,IAAgB;EAClC,OAAO,CAACC,QAAD,EAAWC,OAAX,EAAoBC,QAApB,KAAiC;IACtC,IAAI,OAAOD,OAAP,KAAmB,UAAvB,EAAmC;MACjCC,QAAQ,GAAGD,OAAX;MACAA,OAAO,GAAG,IAAV;IACD,CAHD,MAGO,IAAI,OAAOA,OAAP,KAAmB,QAAvB,EAAiC;MACtCA,OAAO,GAAG;QAAEX,MAAM,EAAEW;MAAV,CAAV;IACD;;IAEDA,OAAO,GAAG,EAAE,GAAGb,cAAL;MAAqB,GAAGa;IAAxB,CAAV;IAEA,MAAME,GAAG,GAAGC,IAAI,CAACC,SAAL,CAAe;MACzBL,QADyB;MAEzBV,MAAM,EAAEW,OAAO,CAACX,MAFS;MAGzBE,KAAK,EAAES,OAAO,CAACT,KAHU;MAIzBE,GAAG,EAAEO,OAAO,CAACP,GAJY;MAKzBC,QAAQ,EAAEM,OAAO,CAACN;IALO,CAAf,CAAZ;;IAQA,IAAIC,WAAW,CAACU,GAAZ,CAAgBH,GAAhB,CAAJ,EAA0B;MACxB,MAAM,CAACI,OAAD,EAAUjB,MAAV,IAAoBM,WAAW,CAACY,GAAZ,CAAgBL,GAAhB,CAA1B;MACAM,OAAO,CAACC,QAAR,CAAiBR,QAAjB,EAA2B,IAA3B,EAAiCK,OAAjC,EAA0CjB,MAA1C;MACA;IACD;;IAEDS,UAAU,CAACY,MAAX,CAAkBX,QAAlB,EAA4BC,OAA5B,EAAqC,CAACW,GAAD,EAAML,OAAN,EAAejB,MAAf,KAA0B;MAC7D,IAAIsB,GAAJ,EAAS;QACP,OAAOV,QAAQ,CAACU,GAAD,CAAf;MACD;;MAEDhB,WAAW,CAACiB,GAAZ,CAAgBV,GAAhB,EAAqB,CAACI,OAAD,EAAUjB,MAAV,CAArB,EAAwC;QAAEwB,GAAG,EAAEf,UAAU,CAACe;MAAlB,CAAxC;MACA,OAAOZ,QAAQ,CAAC,IAAD,EAAOK,OAAP,EAAgBjB,MAAhB,CAAf;IACD,CAPD;EAQD,CAhCD;AAiCD,CAlCD"},"metadata":{},"sourceType":"script"}